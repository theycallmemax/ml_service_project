# ML-сервис

## Обзор

ML-сервис является компонентом машинного обучения проекта, отвечающим за обучение моделей, генерацию предсказаний цен криптовалют и предоставление API для сервисов предсказания. Он использует различные алгоритмы для предсказания будущих цен на основе исторических данных.

## Функции

- **Множественные модели предсказания**: Поддержка Random Forest, XGBoost и LightGBM
- **Автоматическое переобучение**: Ежедневное переобучение моделей с новыми данными
- **Поддержка криптовалют**: Предсказания для различных криптовалют (BTC, ETH, LTC и др.)
- **Различные горизонты прогнозирования**: Поддержка различных периодов предсказания (1-30 дней)
- **Интеграция исторических данных**: Загрузка и обработка исторических данных о ценах
- **Сохранение моделей**: Сохранение и загрузка обученных моделей

## Технологический стек

- **Фреймворк**: FastAPI
- **Библиотеки ML**: scikit-learn, XGBoost, LightGBM
- **Обработка данных**: Pandas, NumPy
- **Визуализация данных**: Matplotlib
- **API-клиент**: PyBit для данных о криптовалютах

## Структура

```
ml_service/
├── app/
│   ├── __init__.py
│   ├── debug.py           # Утилиты отладки
│   ├── debug_load_models.py  # Утилиты загрузки моделей
│   └── main.py            # Основное приложение
├── data/                  # Каталог для хранения исторических данных
├── models/                # Каталог для хранения обученных моделей
├── model.ipynb           # Jupyter notebook для разработки моделей
├── poetry.lock           # Файл фиксации зависимостей Poetry
└── pyproject.toml        # Конфигурация проекта
```

## API Эндпоинты

Сервис предоставляет следующие основные эндпоинты:

- `/predict`: Генерация предсказаний для конкретной криптовалюты
- `/retrain`: Запуск ручного переобучения моделей
- `/model-info`: Получение информации о доступных моделях
- `/health`: Эндпоинт проверки работоспособности
- `/current-price`: Получение текущих цен криптовалют

## Детали моделей

Сервис поддерживает несколько типов моделей:

- **Random Forest**: Универсальный метод ансамблевого обучения для регрессии
- **XGBoost**: Оптимизированная библиотека машинного обучения с градиентным бустингом
- **LightGBM**: Фреймворк градиентного бустинга, использующий алгоритмы обучения на основе деревьев

## Разработка

### Предварительные требования

- Python 3.8+
- Poetry

### Настройка

```bash
# Установка зависимостей
cd ml_service
poetry install

# Запуск приложения
poetry run uvicorn app.main:app --reload
```

## Docker

Сервис контейнеризирован и может быть запущен с использованием Docker и docker-compose. См. README корневого проекта для инструкций.